GenerateUploadUrl:
  tracing: true
  handler: src/lambda/http/attachment/generateUploadUrl.main
  events:
    - http:
        method: post
        path: attachments
        cors: true
        authorizer: Auth
  iamRoleStatements:
    - Effect: Allow
      Action: 
        - s3:*
      Resource: arn:aws:s3:::${self:provider.environment.ATTACHMENTS_S3_BUCKET}/*
    - Effect: Allow
      Action:
        - dynamodb:UpdateItem
        - xray:PutTelemetryRecords
        - xray:PutTraceSegments
      Resource:
        - 'arn:aws:dynamodb:${self:provider.region}:*:table/${self:provider.environment.COLLECTION_TABLE}'
        - 'arn:aws:dynamodb:${self:provider.region}:*:table/${self:provider.environment.ITEM_TABLE}'
        - 'arn:aws:dynamodb:${self:provider.region}:*:table/${self:provider.environment.LOCATION_TABLE}'